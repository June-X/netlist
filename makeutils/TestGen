#!/bin/bash

for test in $@ ; do
  imports="$imports
import Test.$test"
  if [ -z "$shortmap" ] ; then
    shortmap="shortMap = M.fromList [(\"$test\", Test.$test.shortTests)"
  else
    shortmap="$shortmap
                      ,(\"$test\", Test.$test.shortTests)"
  fi
  shortmap="$shortmap
                      ,(\"$test-long\", Test.$test.longTests)"
done

if [ -n "$shortmap" ] ; then
  shortmap="$shortmap
                      ]"
fi

echo "
-- Autogenerated file: do not edit. Edit TestGen and/or Makefile instead
-- FIXME these names are NOT cabal friendly. Think of how somebody else
--   would use these packages/run tests etc.
import Control.Monad
import Data.Map as M
import System.Environment

$imports

$shortmap

main = mapM_ (shortMap !) =<< getArgs
"
